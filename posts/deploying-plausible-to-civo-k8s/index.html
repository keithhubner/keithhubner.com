<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Keith Hubner</title>
<meta name=keywords content><meta name=description content="In this blog post, we will explore how to deploy Plausible Analytics to a Civo Kubernetes cluster. Plausible is a lightweight and open-source web analytics tool that prioritizes privacy and simplicity. It provides website owners with essential insights without compromising user privacy.
Civo is a cloud service provider that offers a developer-friendly Kubernetes platform. With its fast and efficient Kubernetes clusters, Civo makes it easy to deploy and manage containerized applications."><meta name=author content="Keith Hubner"><link rel=canonical href=https://keithhubner.github.io/keithhubner.com/posts/deploying-plausible-to-civo-k8s/><link crossorigin=anonymous href=/keithhubner.com/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://keithhubner.github.io/keithhubner.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keithhubner.github.io/keithhubner.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keithhubner.github.io/keithhubner.com/favicon-32x32.png><link rel=apple-touch-icon href=https://keithhubner.github.io/keithhubner.com/apple-touch-icon.png><link rel=mask-icon href=https://keithhubner.github.io/keithhubner.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keithhubner.github.io/keithhubner.com/posts/deploying-plausible-to-civo-k8s/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keithhubner.github.io/keithhubner.com/posts/deploying-plausible-to-civo-k8s/"><meta property="og:site_name" content="Keith Hubner"><meta property="og:title" content="Keith Hubner"><meta property="og:description" content="In this blog post, we will explore how to deploy Plausible Analytics to a Civo Kubernetes cluster. Plausible is a lightweight and open-source web analytics tool that prioritizes privacy and simplicity. It provides website owners with essential insights without compromising user privacy.
Civo is a cloud service provider that offers a developer-friendly Kubernetes platform. With its fast and efficient Kubernetes clusters, Civo makes it easy to deploy and manage containerized applications."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="In this blog post, we will explore how to deploy Plausible Analytics to a Civo Kubernetes cluster. Plausible is a lightweight and open-source web analytics tool that prioritizes privacy and simplicity. It provides website owners with essential insights without compromising user privacy.
Civo is a cloud service provider that offers a developer-friendly Kubernetes platform. With its fast and efficient Kubernetes clusters, Civo makes it easy to deploy and manage containerized applications."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"All Posts","item":"https://keithhubner.github.io/keithhubner.com/posts/"},{"@type":"ListItem","position":2,"name":"","item":"https://keithhubner.github.io/keithhubner.com/posts/deploying-plausible-to-civo-k8s/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"In this blog post, we will explore how to deploy Plausible Analytics to a Civo Kubernetes cluster. Plausible is a lightweight and open-source web analytics tool that prioritizes privacy and simplicity. It provides website owners with essential insights without compromising user privacy.\nCivo is a cloud service provider that offers a developer-friendly Kubernetes platform. With its fast and efficient Kubernetes clusters, Civo makes it easy to deploy and manage containerized applications.\n","keywords":[],"articleBody":"In this blog post, we will explore how to deploy Plausible Analytics to a Civo Kubernetes cluster. Plausible is a lightweight and open-source web analytics tool that prioritizes privacy and simplicity. It provides website owners with essential insights without compromising user privacy.\nCivo is a cloud service provider that offers a developer-friendly Kubernetes platform. With its fast and efficient Kubernetes clusters, Civo makes it easy to deploy and manage containerized applications.\nBy the end of this guide, you will have a fully functional Plausible Analytics instance running on a Civo Kubernetes cluster. Let’s get started!\nPrerequisites Before you begin, ensure you have the following prerequisites:\nCivo Account: You need a Civo account. If you don’t have one, you can sign up at Civo’s website. Civo CLI: Install the Civo CLI tool on your local machine. You can find the installation instructions here. kubectl: Ensure you have kubectl installed and configured to interact with your Kubernetes cluster. You can download it from Kubernetes’ official site. Helm: Install Helm, the package manager for Kubernetes. Follow the installation guide here. Docker: Make sure Docker is installed and running on your local machine. You can download it from Docker’s official site. Domain Name: A domain name for your Plausible instance. You can purchase one from any domain registrar. Basic Knowledge: Familiarity with Kubernetes concepts and command-line tools. Once you have these prerequisites in place, you are ready to proceed with setting up your Civo Kubernetes cluster.\nSetting Up Civo Kubernetes Cluster To set up a Civo Kubernetes cluster using the CLI, follow these steps:\nLog in to Civo CLI: Open your terminal and log in to your Civo account using the CLI.\ncivo apikey save Enter a nice name for this account/API Key: civo-demo Enter the API key: Saved the API Key civo-demo Set the Default Region: Set the default region for your Civo account. Replace LON1 with your desired region.\ncivo region ls civo region use LON1 Create a Kubernetes Cluster: Use the following command to create a new Kubernetes cluster. Replace my-cluster with your desired cluster name. The --wait flag ensures the command waits until the cluster is ready, and the --save and --merge flags automatically configure kubectl to use the new cluster.\ncivo k8s create my-cluster --nodes=3 --size=g4s.kube.medium --wait --save --merge Verify the Configuration: Verify that kubectl is configured correctly by listing the nodes in your cluster.\nkubectl get nodes Your Civo Kubernetes cluster is now set up and ready for deploying applications.\nDeploying Cert-Manager for HTTPS To serve Plausible over HTTPS, we need to deploy Cert-Manager to our Kubernetes cluster. Cert-Manager automates the management and issuance of TLS certificates.\nAdd the Jetstack Helm Repository: First, add the Jetstack Helm repository, which contains the Cert-Manager Helm chart.\nhelm repo add jetstack https://charts.jetstack.io helm repo update Install Cert-Manager: Use Helm to install Cert-Manager in your cluster.\nhelm install cert-manager jetstack/cert-manager --namespace cert-manager --create-namespace --version v1.6.1 --set installCRDs=true Verify the Installation: Ensure that Cert-Manager is installed and running.\nkubectl get pods --namespace cert-manager Create a ClusterIssuer: Create a ClusterIssuer resource to define how certificates will be issued. Save the following YAML to a file named cluster-issuer.yaml:\nFor production certificates:\napiVersion: cert-manager.io/v1 kind: ClusterIssuer metadata: name: letsencrypt-prod spec: acme: server: https://acme-v02.api.letsencrypt.org/directory email: your-email@example.com privateKeySecretRef: name: letsencrypt-prod solvers: - http01: ingress: class: nginx For staging certificates (useful for testing to avoid hitting rate limits):\napiVersion: cert-manager.io/v1 kind: ClusterIssuer metadata: name: letsencrypt-staging spec: acme: server: https://acme-staging-v02.api.letsencrypt.org/directory email: your-email@example.com privateKeySecretRef: name: letsencrypt-staging solvers: - http01: ingress: class: nginx Apply the ClusterIssuer to your cluster:\nkubectl apply -f cluster-issuer.yaml Note: It is recommended to use the staging environment first to ensure your configuration is correct without hitting Let’s Encrypt’s rate limits. Once verified, you can switch to the production environment.\nWith Cert-Manager deployed and configured, you can now proceed to install Plausible Analytics and configure it to use HTTPS.\nInstalling Plausible Analytics To install Plausible Analytics on your Civo Kubernetes cluster, follow these steps:\nCreate a Namespace for Plausible: Create a new namespace in your Kubernetes cluster for Plausible.\nkubectl create namespace plausible Create a PostgreSQL Database: Use the Civo CLI to create a new PostgreSQL database. Replace my-database with your desired database name.\ncivo db create my-database --size=g3.db.small --software psql --version 14 Retrieve Database Credentials: Once the database is created, retrieve the credentials and connection details.\ncivo db show my-database civo db credential my-database Create a Secret for Plausible Configuration: Create a Kubernetes secret to store your Plausible configuration. Replace the placeholder values with your actual configuration.\nkubectl create secret generic plausible-config --namespace plausible \\ --from-literal=SECRET_KEY_BASE=\"$(openssl rand -base64 64)\" \\ --from-literal=BASE_URL=\"https://URL\" \\ --from-literal=POSTGRES_PASSWORD=\"password\" \\ --from-literal=POSTGRES_DB=\"plausible_db\" \\ --from-literal=POSTGRES_USER=\"DB USER\" \\ --from-literal=POSTGRES_HOST=\"DB URL\" \\ --from-literal=POSTGRES_PORT=\"5432\" Create a Deployment for Plausible: Create a file named plausible-deployment.yaml with the following content:\napiVersion: apps/v1 kind: Deployment metadata: name: plausible namespace: plausible spec: replicas: 1 selector: matchLabels: app: plausible template: metadata: labels: app: plausible spec: containers: - name: plausible image: plausible/analytics:latest env: - name: SECRET_KEY_BASE valueFrom: secretKeyRef: name: plausible-config key: SECRET_KEY_BASE - name: BASE_URL valueFrom: secretKeyRef: name: plausible-config key: BASE_URL - name: DATABASE_URL valueFrom: secretKeyRef: name: plausible-config key: DATABASE_URL ports: - containerPort: 8000 Create a Service for Plausible: Create a file named plausible-service.yaml with the following content:\napiVersion: v1 kind: Service metadata: name: plausible namespace: plausible spec: selector: app: plausible ports: - protocol: TCP port: 80 targetPort: 8000 Deploy the Manifests: Apply the manifests to your Kubernetes cluster.\nkubectl apply -f plausible-deployment.yaml --namespace plausible kubectl apply -f plausible-service.yaml --namespace plausible Deploy Ingress: Create an Ingress resource to expose Plausible via HTTPS. Make sure to update the host to your domain.\nFor production certificates:\napiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: plausible-ingress namespace: plausible annotations: cert-manager.io/cluster-issuer: letsencrypt-prod spec: rules: - host: your-domain.com http: paths: - path: / pathType: Prefix backend: service: name: plausible port: number: 8000 tls: - hosts: - your-domain.com secretName: plausible-tls For staging certificates:\napiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: plausible-ingress namespace: plausible annotations: cert-manager.io/cluster-issuer: letsencrypt-staging spec: rules: - host: your-domain.com http: paths: - path: / pathType: Prefix backend: service: name: plausible port: number: 8000 tls: - hosts: - your-domain.com secretName: plausible-tls ``` Apply the Ingress resource: ```sh kubectl apply -f ingress.yaml --namespace plausible ``` With these steps, Plausible Analytics should be up and running on your Civo Kubernetes cluster. You can now proceed to configure and verify your deployment. ## Configuring Plausible Analytics ## Deploying Plausible to Civo Kubernetes ## Verifying the Deployment ## Conclusion ","wordCount":"1063","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Keith Hubner"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://keithhubner.github.io/keithhubner.com/posts/deploying-plausible-to-civo-k8s/"},"publisher":{"@type":"Organization","name":"Keith Hubner","logo":{"@type":"ImageObject","url":"https://keithhubner.github.io/keithhubner.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keithhubner.github.io/keithhubner.com/ accesskey=h title="Keith Hubner (Alt + H)">Keith Hubner</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keithhubner.github.io/keithhubner.com/ title=Home><span>Home</span></a></li><li><a href=https://keithhubner.github.io/keithhubner.com/about/ title="About Me"><span>About Me</span></a></li><li><a href=https://keithhubner.github.io/keithhubner.com/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://keithhubner.github.io/keithhubner.com/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent"></h1><div class=post-meta>Keith Hubner</div></header><div class=post-content><p>In this blog post, we will explore how to deploy Plausible Analytics to a Civo Kubernetes cluster. Plausible is a lightweight and open-source web analytics tool that prioritizes privacy and simplicity. It provides website owners with essential insights without compromising user privacy.</p><p>Civo is a cloud service provider that offers a developer-friendly Kubernetes platform. With its fast and efficient Kubernetes clusters, Civo makes it easy to deploy and manage containerized applications.</p><p>By the end of this guide, you will have a fully functional Plausible Analytics instance running on a Civo Kubernetes cluster. Let&rsquo;s get started!</p><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><p>Before you begin, ensure you have the following prerequisites:</p><ol><li><strong>Civo Account</strong>: You need a Civo account. If you don&rsquo;t have one, you can sign up at <a href=https://www.civo.com/>Civo&rsquo;s website</a>.</li><li><strong>Civo CLI</strong>: Install the Civo CLI tool on your local machine. You can find the installation instructions <a href=https://www.civo.com/docs/cli>here</a>.</li><li><strong>kubectl</strong>: Ensure you have <code>kubectl</code> installed and configured to interact with your Kubernetes cluster. You can download it from <a href=https://kubernetes.io/docs/tasks/tools/install-kubectl/>Kubernetes&rsquo; official site</a>.</li><li><strong>Helm</strong>: Install Helm, the package manager for Kubernetes. Follow the installation guide <a href=https://helm.sh/docs/intro/install/>here</a>.</li><li><strong>Docker</strong>: Make sure Docker is installed and running on your local machine. You can download it from <a href=https://www.docker.com/products/docker-desktop>Docker&rsquo;s official site</a>.</li><li><strong>Domain Name</strong>: A domain name for your Plausible instance. You can purchase one from any domain registrar.</li><li><strong>Basic Knowledge</strong>: Familiarity with Kubernetes concepts and command-line tools.</li></ol><p>Once you have these prerequisites in place, you are ready to proceed with setting up your Civo Kubernetes cluster.</p><h2 id=setting-up-civo-kubernetes-cluster>Setting Up Civo Kubernetes Cluster<a hidden class=anchor aria-hidden=true href=#setting-up-civo-kubernetes-cluster>#</a></h2><p>To set up a Civo Kubernetes cluster using the CLI, follow these steps:</p><ol><li><p><strong>Log in to Civo CLI</strong>: Open your terminal and log in to your Civo account using the CLI.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>civo apikey save
</span></span><span style=display:flex><span>Enter a nice name <span style=color:#66d9ef>for</span> this account/API Key: civo-demo
</span></span><span style=display:flex><span>Enter the API key:
</span></span><span style=display:flex><span>Saved the API Key civo-demo
</span></span></code></pre></div></li><li><p><strong>Set the Default Region</strong>: Set the default region for your Civo account. Replace <code>LON1</code> with your desired region.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>civo region ls
</span></span><span style=display:flex><span>civo region use LON1
</span></span></code></pre></div></li><li><p><strong>Create a Kubernetes Cluster</strong>: Use the following command to create a new Kubernetes cluster. Replace <code>my-cluster</code> with your desired cluster name. The <code>--wait</code> flag ensures the command waits until the cluster is ready, and the <code>--save</code> and <code>--merge</code> flags automatically configure <code>kubectl</code> to use the new cluster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>civo k8s create my-cluster --nodes<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> --size<span style=color:#f92672>=</span>g4s.kube.medium --wait --save --merge
</span></span></code></pre></div></li><li><p><strong>Verify the Configuration</strong>: Verify that <code>kubectl</code> is configured correctly by listing the nodes in your cluster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get nodes
</span></span></code></pre></div></li></ol><p>Your Civo Kubernetes cluster is now set up and ready for deploying applications.</p><h2 id=deploying-cert-manager-for-https>Deploying Cert-Manager for HTTPS<a hidden class=anchor aria-hidden=true href=#deploying-cert-manager-for-https>#</a></h2><p>To serve Plausible over HTTPS, we need to deploy Cert-Manager to our Kubernetes cluster. Cert-Manager automates the management and issuance of TLS certificates.</p><ol><li><p><strong>Add the Jetstack Helm Repository</strong>: First, add the Jetstack Helm repository, which contains the Cert-Manager Helm chart.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>helm repo add jetstack https://charts.jetstack.io
</span></span><span style=display:flex><span>helm repo update
</span></span></code></pre></div></li><li><p><strong>Install Cert-Manager</strong>: Use Helm to install Cert-Manager in your cluster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>helm install cert-manager jetstack/cert-manager --namespace cert-manager --create-namespace --version v1.6.1 --set installCRDs<span style=color:#f92672>=</span>true
</span></span></code></pre></div></li><li><p><strong>Verify the Installation</strong>: Ensure that Cert-Manager is installed and running.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods --namespace cert-manager
</span></span></code></pre></div></li><li><p><strong>Create a ClusterIssuer</strong>: Create a ClusterIssuer resource to define how certificates will be issued. Save the following YAML to a file named <code>cluster-issuer.yaml</code>:</p><p>For production certificates:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencrypt-prod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>acme</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>: <span style=color:#ae81ff>https://acme-v02.api.letsencrypt.org/directory</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>email</span>: <span style=color:#ae81ff>your-email@example.com</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privateKeySecretRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencrypt-prod</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>solvers</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>http01</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>ingress</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>class</span>: <span style=color:#ae81ff>nginx</span>
</span></span></code></pre></div><p>For staging certificates (useful for testing to avoid hitting rate limits):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencrypt-staging</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>acme</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>: <span style=color:#ae81ff>https://acme-staging-v02.api.letsencrypt.org/directory</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>email</span>: <span style=color:#ae81ff>your-email@example.com</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privateKeySecretRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencrypt-staging</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>solvers</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>http01</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>ingress</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>class</span>: <span style=color:#ae81ff>nginx</span>
</span></span></code></pre></div><p>Apply the ClusterIssuer to your cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl apply -f cluster-issuer.yaml
</span></span></code></pre></div><p><strong>Note</strong>: It is recommended to use the staging environment first to ensure your configuration is correct without hitting Let&rsquo;s Encrypt&rsquo;s rate limits. Once verified, you can switch to the production environment.</p></li></ol><p>With Cert-Manager deployed and configured, you can now proceed to install Plausible Analytics and configure it to use HTTPS.</p><h2 id=installing-plausible-analytics>Installing Plausible Analytics<a hidden class=anchor aria-hidden=true href=#installing-plausible-analytics>#</a></h2><p>To install Plausible Analytics on your Civo Kubernetes cluster, follow these steps:</p><ol><li><p><strong>Create a Namespace for Plausible</strong>: Create a new namespace in your Kubernetes cluster for Plausible.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create namespace plausible
</span></span></code></pre></div></li><li><p><strong>Create a PostgreSQL Database</strong>: Use the Civo CLI to create a new PostgreSQL database. Replace <code>my-database</code> with your desired database name.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>civo db create my-database --size<span style=color:#f92672>=</span>g3.db.small --software psql --version <span style=color:#ae81ff>14</span>
</span></span></code></pre></div></li><li><p><strong>Retrieve Database Credentials</strong>: Once the database is created, retrieve the credentials and connection details.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>civo db show my-database
</span></span><span style=display:flex><span>civo db credential my-database
</span></span></code></pre></div></li><li><p><strong>Create a Secret for Plausible Configuration</strong>: Create a Kubernetes secret to store your Plausible configuration. Replace the placeholder values with your actual configuration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create secret generic plausible-config --namespace plausible <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>SECRET_KEY_BASE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>openssl rand -base64 64<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>BASE_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://URL&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>POSTGRES_PASSWORD<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>POSTGRES_DB<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;plausible_db&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>POSTGRES_USER<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;DB USER&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>POSTGRES_HOST<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;DB URL&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>POSTGRES_PORT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;5432&#34;</span>
</span></span></code></pre></div></li><li><p><strong>Create a Deployment for Plausible</strong>: Create a file named <code>plausible-deployment.yaml</code> with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>image</span>: <span style=color:#ae81ff>plausible/analytics:latest</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SECRET_KEY_BASE</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible-config</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>key</span>: <span style=color:#ae81ff>SECRET_KEY_BASE</span>
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>BASE_URL</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible-config</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>key</span>: <span style=color:#ae81ff>BASE_URL</span>
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>DATABASE_URL</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible-config</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>key</span>: <span style=color:#ae81ff>DATABASE_URL</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>8000</span>
</span></span></code></pre></div></li><li><p><strong>Create a Service for Plausible</strong>: Create a file named <code>plausible-service.yaml</code> with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>8000</span>
</span></span></code></pre></div></li><li><p><strong>Deploy the Manifests</strong>: Apply the manifests to your Kubernetes cluster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl apply -f plausible-deployment.yaml --namespace plausible
</span></span><span style=display:flex><span>kubectl apply -f plausible-service.yaml --namespace plausible
</span></span></code></pre></div></li><li><p><strong>Deploy Ingress</strong>: Create an Ingress resource to expose Plausible via HTTPS. Make sure to update the host to your domain.</p></li></ol><p>For production certificates:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>    <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible-ingress</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>cert-manager.io/cluster-issuer</span>: <span style=color:#ae81ff>letsencrypt-prod</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>host</span>: <span style=color:#ae81ff>your-domain.com</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>pathType</span>: <span style=color:#ae81ff>Prefix</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>port</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>number</span>: <span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>tls</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>your-domain.com</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>plausible-tls</span>
</span></span></code></pre></div><p>For staging certificates:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>    <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible-ingress</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>cert-manager.io/cluster-issuer</span>: <span style=color:#ae81ff>letsencrypt-staging</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>host</span>: <span style=color:#ae81ff>your-domain.com</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>pathType</span>: <span style=color:#ae81ff>Prefix</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>name</span>: <span style=color:#ae81ff>plausible</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>port</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>number</span>: <span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>tls</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>your-domain.com</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>plausible-tls</span>
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>```</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Apply the Ingress resource</span>:
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>```sh</span>
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>kubectl apply -f ingress.yaml --namespace plausible</span>
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>```</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>With these steps, Plausible Analytics should be up and running on your Civo Kubernetes cluster. You can now proceed to configure and verify your deployment.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Configuring Plausible Analytics</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Deploying Plausible to Civo Kubernetes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Verifying the Deployment</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Conclusion</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://keithhubner.github.io/keithhubner.com/>Keith Hubner</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><p>Get in touch:</p><ul><li><a href=mailto:yourname@example.com>Email</a></li><li><a href=https://linkedin.com/in/yourprofile>LinkedIn</a></li><li><a href=https://github.com/yourusername>GitHub</a></li></ul></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>