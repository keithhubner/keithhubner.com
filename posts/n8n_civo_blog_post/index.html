<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deploy n8n to Civo Kubernetes | Keith Hubner</title>
<meta name=keywords content="kubernetes,n8n,civo,automation,devops,cloud"><meta name=description content="Learn how to deploy n8n workflow automation to a Civo Kubernetes cluster with this comprehensive step-by-step guide. Includes setup for new and existing clusters."><meta name=author content="Keith Hubner"><link rel=canonical href=https://blog.keithhubner.com/posts/n8n_civo_blog_post/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.keithhubner.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.keithhubner.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.keithhubner.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.keithhubner.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.keithhubner.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.keithhubner.com/posts/n8n_civo_blog_post/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script defer data-domain=blog.keithhubner.com src=https://plausible.jankylabs.co.uk/js/script.js></script><meta property="og:url" content="https://blog.keithhubner.com/posts/n8n_civo_blog_post/"><meta property="og:site_name" content="Keith Hubner"><meta property="og:title" content="Deploy n8n to Civo Kubernetes"><meta property="og:description" content="Learn how to deploy n8n workflow automation to a Civo Kubernetes cluster with this comprehensive step-by-step guide. Includes setup for new and existing clusters."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-17T10:00:00+00:00"><meta property="article:modified_time" content="2025-06-17T10:00:00+00:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="N8n"><meta property="article:tag" content="Civo"><meta property="article:tag" content="Automation"><meta property="article:tag" content="Devops"><meta property="article:tag" content="Cloud"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploy n8n to Civo Kubernetes"><meta name=twitter:description content="Learn how to deploy n8n workflow automation to a Civo Kubernetes cluster with this comprehensive step-by-step guide. Includes setup for new and existing clusters."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"All Posts","item":"https://blog.keithhubner.com/posts/"},{"@type":"ListItem","position":2,"name":"Deploy n8n to Civo Kubernetes","item":"https://blog.keithhubner.com/posts/n8n_civo_blog_post/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deploy n8n to Civo Kubernetes","name":"Deploy n8n to Civo Kubernetes","description":"Learn how to deploy n8n workflow automation to a Civo Kubernetes cluster with this comprehensive step-by-step guide. Includes setup for new and existing clusters.","keywords":["kubernetes","n8n","civo","automation","devops","cloud"],"articleBody":" n8n is a powerful workflow automation tool that helps you connect different services and automate repetitive tasks. When combined with Kubernetes on Civo’s developer-friendly cloud platform, you get a scalable, reliable automation solution that can grow with your needs.\nIn this guide, we’ll walk through deploying n8n to a Civo Kubernetes cluster, whether you’re starting fresh or working with an existing cluster.\nWhat You’ll Need Before we begin, make sure you have:\nA Civo account (sign up at civo.com if you don’t have one, you should!) kubectl installed on your local machine civo CLI tool installed Basic familiarity with Kubernetes concepts Step 1: Set Up Your Civo Kubernetes Cluster For New Clusters First, let’s create a new Kubernetes cluster on Civo. We’ll use a medium-sized cluster that’s perfect for running n8n:\n# Install Civo CLI if you haven't already curl -sL https://civo.com/get | sh # Login to your Civo account civo apikey save my-key YOUR_API_KEY_HERE # Create a new Kubernetes cluster civo kubernetes create n8n-cluster \\ --size g4s.kube.medium \\ --nodes 2 \\ --wait This creates a 2-node cluster with sufficient resources for n8n and room to grow.\nFor Existing Clusters If you already have a Civo Kubernetes cluster, simply get your kubeconfig:\n# List your clusters civo kubernetes list # Download the kubeconfig for your cluster civo kubernetes config n8n-cluster --save Verify your connection:\nkubectl get nodes You should see your cluster nodes listed and ready.\nStep 2: Create a Dedicated Namespace Let’s create a dedicated namespace for n8n to keep things organized:\nkubectl create namespace n8n # Set this as your default namespace for convenience kubectl config set-context --current --namespace=n8n Step 3: Set Up Persistent Storage n8n needs persistent storage to save your workflows, credentials, and execution data. We’ll create a PersistentVolumeClaim:\n# Create a file called n8n-pvc.yaml apiVersion: v1 kind: PersistentVolumeClaim metadata: name: n8n-data namespace: n8n spec: accessModes: - ReadWriteOnce resources: requests: storage: 10Gi storageClassName: civo-volume Apply the PVC:\nkubectl apply -f n8n-pvc.yaml Step 4: Configure n8n Environment Variables Create a ConfigMap for n8n configuration:\n# Create n8n-config.yaml apiVersion: v1 kind: ConfigMap metadata: name: n8n-config namespace: n8n data: N8N_HOST: \"n8n.yourdomain.com\" # Replace with your domain N8N_PORT: \"5678\" N8N_PROTOCOL: \"https\" WEBHOOK_URL: \"https://n8n.yourdomain.com/\" GENERIC_TIMEZONE: \"UTC\" N8N_LOG_LEVEL: \"info\" For sensitive data like database credentials, create a Secret:\n# Create n8n-secrets.yaml apiVersion: v1 kind: Secret metadata: name: n8n-secrets namespace: n8n type: Opaque stringData: N8N_BASIC_AUTH_USER: \"admin\" N8N_BASIC_AUTH_PASSWORD: \"your-secure-password-here\" N8N_ENCRYPTION_KEY: \"your-encryption-key-here\" # Generate a random 32-character string Apply both configurations:\nkubectl apply -f n8n-config.yaml kubectl apply -f n8n-secrets.yaml Step 5: Deploy n8n Now let’s create the main n8n deployment:\n# Create n8n-deployment.yaml apiVersion: apps/v1 kind: Deployment metadata: name: n8n namespace: n8n labels: app: n8n spec: replicas: 1 selector: matchLabels: app: n8n template: metadata: labels: app: n8n spec: # Fix permissions for the mounted volume securityContext: fsGroup: 1000 runAsUser: 1000 runAsGroup: 1000 # Use an init container to fix permissions if needed initContainers: - name: volume-permissions image: busybox:1.35 command: - sh - -c - | chown -R 1000:1000 /home/node/.n8n chmod -R 755 /home/node/.n8n volumeMounts: - name: n8n-data mountPath: /home/node/.n8n securityContext: runAsUser: 0 containers: - name: n8n image: n8nio/n8n:latest ports: - containerPort: 5678 envFrom: - configMapRef: name: n8n-config - secretRef: name: n8n-secrets volumeMounts: - name: n8n-data mountPath: /home/node/.n8n resources: requests: memory: \"512Mi\" cpu: \"250m\" limits: memory: \"1Gi\" cpu: \"500m\" # Give the init container time to fix permissions livenessProbe: httpGet: path: /healthz port: 5678 initialDelaySeconds: 60 periodSeconds: 10 readinessProbe: httpGet: path: /healthz port: 5678 initialDelaySeconds: 30 periodSeconds: 5 securityContext: runAsUser: 1000 runAsGroup: 1000 allowPrivilegeEscalation: false readOnlyRootFilesystem: false volumes: - name: n8n-data persistentVolumeClaim: claimName: n8n-data Deploy n8n:\nkubectl apply -f n8n-deployment.yaml Step 6: Expose n8n with a Service Create a service to expose n8n within the cluster:\n# Create n8n-service.yaml apiVersion: v1 kind: Service metadata: name: n8n-service namespace: n8n spec: selector: app: n8n ports: - port: 80 targetPort: 5678 protocol: TCP type: ClusterIP Apply the service:\nkubectl apply -f n8n-service.yaml Step 7: Install and Configure cert-manager Before setting up ingress, we need cert-manager to handle SSL certificates automatically. cert-manager will obtain Let’s Encrypt certificates for our domain.\nInstall cert-manager using Helm or kubectl:\n# Add the Jetstack Helm repository helm repo add jetstack https://charts.jetstack.io helm repo update # Install cert-manager helm install cert-manager jetstack/cert-manager \\ --namespace cert-manager \\ --create-namespace \\ --version v1.12.0 \\ --set installCRDs=true Alternatively, you can install with kubectl:\n# Install cert-manager CRDs kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.12.0/cert-manager.crds.yaml # Create namespace kubectl create namespace cert-manager # Install cert-manager kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.12.0/cert-manager.yaml Wait for cert-manager to be ready:\nkubectl wait --for=condition=ready pod -l app.kubernetes.io/instance=cert-manager -n cert-manager --timeout=300s Now create a ClusterIssuer for Let’s Encrypt:\n# Create letsencrypt-issuer.yaml apiVersion: cert-manager.io/v1 kind: ClusterIssuer metadata: name: letsencrypt-prod spec: acme: # Replace with your email address email: your-email@example.com server: https://acme-v02.api.letsencrypt.org/directory privateKeySecretRef: name: letsencrypt-prod solvers: - http01: ingress: class: traefik Apply the ClusterIssuer:\nkubectl apply -f letsencrypt-issuer.yaml Verify cert-manager is working:\n# Check cert-manager pods kubectl get pods -n cert-manager # Check the ClusterIssuer kubectl get clusterissuer letsencrypt-prod Step 8: Set Up Ingress for External Access To access n8n from the internet, we need an ingress controller. Civo clusters come with Traefik pre-installed, so we can use that:\n# Create n8n-ingress.yaml apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: n8n-ingress namespace: n8n annotations: kubernetes.io/ingress.class: \"traefik\" cert-manager.io/cluster-issuer: \"letsencrypt-prod\" traefik.ingress.kubernetes.io/redirect-entry-point: https spec: tls: - hosts: - n8n.yourdomain.com secretName: n8n-tls rules: - host: n8n.yourdomain.com http: paths: - path: / pathType: Prefix backend: service: name: n8n-service port: number: 80 Apply the ingress:\nkubectl apply -f n8n-ingress.yaml Step 9: Configure DNS Point your domain to your Civo cluster’s load balancer IP. First, get the external IP:\nkubectl get svc -n kube-system traefik Look for the EXTERNAL-IP and create an A record in your DNS provider pointing n8n.yourdomain.com to this IP.\nStep 10: Verify Your Deployment Check that everything is running correctly:\n# Check pod status kubectl get pods -n n8n # Check service kubectl get svc -n n8n # Check ingress kubectl get ingress -n n8n # Check certificate (should show Ready=True after a few minutes) kubectl get certificate -n n8n # View logs if needed kubectl logs -f deployment/n8n -n n8n You should see output similar to:\nNAME READY STATUS RESTARTS AGE n8n-xxx 1/1 Running 0 2m For the certificate, you should see:\nNAME READY SECRET AGE n8n-tls True n8n-tls 2m Step 11: Access n8n Once your DNS has propagated (this can take a few minutes), you can access n8n at https://n8n.yourdomain.com. The SSL certificate should be automatically provisioned by cert-manager within a few minutes.\nYou’ll be prompted to log in using the credentials you set in the Secret (admin/your-secure-password-here by default).\nCreating Your First Workflow Now that n8n is running, let’s create a simple workflow to test everything:\nAccess the n8n interface at your domain Click “New Workflow” Add a Manual Trigger node - this will be your starting point Add an HTTP Request node - configure it to make a GET request to https://api.github.com/users/octocat Add a Set node - use this to format the response data Connect the nodes by dragging from the output of one to the input of the next Click “Execute Workflow” to test it This simple workflow demonstrates n8n’s ability to fetch data from APIs and process it.\nProduction Considerations For production deployments, consider these additional steps:\nDatabase Configuration Instead of using SQLite (the default), configure n8n to use PostgreSQL for better performance:\n# Add to your n8n-config ConfigMap DB_TYPE: \"postgresdb\" DB_POSTGRESDB_HOST: \"your-postgres-host\" DB_POSTGRESDB_PORT: \"5432\" DB_POSTGRESDB_DATABASE: \"n8n\" Resource Scaling Monitor your n8n instance and adjust resources as needed:\n# Scale up if needed kubectl scale deployment n8n --replicas=2 -n n8n # Update resource limits kubectl patch deployment n8n -n n8n -p '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"n8n\",\"resources\":{\"limits\":{\"memory\":\"2Gi\",\"cpu\":\"1\"}}}]}}}}' Backup Strategy Set up regular backups of your persistent volume and export your workflows:\n# Create a backup job kubectl create job n8n-backup --from=cronjob/n8n-backup -n n8n Monitoring Add monitoring to track n8n’s performance:\n# Add to your deployment - name: metrics port: 9464 targetPort: 9464 Troubleshooting Common Issues Pod Won’t Start - Permission Issues The most common issue is permission problems with the persistent volume. Check the logs:\nkubectl logs deployment/n8n -n n8n If you see EACCES: permission denied errors, the deployment above includes fixes for this. However, if you’re still having issues, you can manually fix permissions:\n# Delete the current deployment kubectl delete deployment n8n -n n8n # Create a one-time job to fix permissions kubectl apply -f - \u003c","wordCount":"1755","inLanguage":"en","datePublished":"2025-06-17T10:00:00Z","dateModified":"2025-06-17T10:00:00Z","author":{"@type":"Person","name":"Keith Hubner"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.keithhubner.com/posts/n8n_civo_blog_post/"},"publisher":{"@type":"Organization","name":"Keith Hubner","logo":{"@type":"ImageObject","url":"https://blog.keithhubner.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.keithhubner.com/ accesskey=h title="Keith Hubner (Alt + H)">Keith Hubner</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.keithhubner.com/ title=Home><span>Home</span></a></li><li><a href=https://blog.keithhubner.com/about/ title="About Me"><span>About Me</span></a></li><li><a href=https://blog.keithhubner.com/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://blog.keithhubner.com/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Deploy n8n to Civo Kubernetes</h1><div class=post-description>Learn how to deploy n8n workflow automation to a Civo Kubernetes cluster with this comprehensive step-by-step guide. Includes setup for new and existing clusters.</div><div class=post-meta><span title='2025-06-17 10:00:00 +0000 UTC'>June 17, 2025</span>&nbsp;·&nbsp;Keith Hubner</div></header><div class=post-content><hr><p>n8n is a powerful workflow automation tool that helps you connect different services and automate repetitive tasks. When combined with Kubernetes on Civo&rsquo;s developer-friendly cloud platform, you get a scalable, reliable automation solution that can grow with your needs.</p><p>In this guide, we&rsquo;ll walk through deploying n8n to a Civo Kubernetes cluster, whether you&rsquo;re starting fresh or working with an existing cluster.</p><h2 id=what-youll-need>What You&rsquo;ll Need<a hidden class=anchor aria-hidden=true href=#what-youll-need>#</a></h2><p>Before we begin, make sure you have:</p><ul><li>A Civo account (sign up at <a href=https://civo.com>civo.com</a> if you don&rsquo;t have one, you should!)</li><li><code>kubectl</code> installed on your local machine</li><li><code>civo</code> CLI tool installed</li><li>Basic familiarity with Kubernetes concepts</li></ul><h2 id=step-1-set-up-your-civo-kubernetes-cluster>Step 1: Set Up Your Civo Kubernetes Cluster<a hidden class=anchor aria-hidden=true href=#step-1-set-up-your-civo-kubernetes-cluster>#</a></h2><h3 id=for-new-clusters>For New Clusters<a hidden class=anchor aria-hidden=true href=#for-new-clusters>#</a></h3><p>First, let&rsquo;s create a new Kubernetes cluster on Civo. We&rsquo;ll use a medium-sized cluster that&rsquo;s perfect for running n8n:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install Civo CLI if you haven&#39;t already</span>
</span></span><span style=display:flex><span>curl -sL https://civo.com/get | sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Login to your Civo account</span>
</span></span><span style=display:flex><span>civo apikey save my-key YOUR_API_KEY_HERE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a new Kubernetes cluster</span>
</span></span><span style=display:flex><span>civo kubernetes create n8n-cluster <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --size g4s.kube.medium <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --nodes <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --wait
</span></span></code></pre></div><p>This creates a 2-node cluster with sufficient resources for n8n and room to grow.</p><h3 id=for-existing-clusters>For Existing Clusters<a hidden class=anchor aria-hidden=true href=#for-existing-clusters>#</a></h3><p>If you already have a Civo Kubernetes cluster, simply get your kubeconfig:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># List your clusters</span>
</span></span><span style=display:flex><span>civo kubernetes list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Download the kubeconfig for your cluster</span>
</span></span><span style=display:flex><span>civo kubernetes config n8n-cluster --save
</span></span></code></pre></div><p>Verify your connection:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get nodes
</span></span></code></pre></div><p>You should see your cluster nodes listed and ready.</p><h2 id=step-2-create-a-dedicated-namespace>Step 2: Create a Dedicated Namespace<a hidden class=anchor aria-hidden=true href=#step-2-create-a-dedicated-namespace>#</a></h2><p>Let&rsquo;s create a dedicated namespace for n8n to keep things organized:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create namespace n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set this as your default namespace for convenience</span>
</span></span><span style=display:flex><span>kubectl config set-context --current --namespace<span style=color:#f92672>=</span>n8n
</span></span></code></pre></div><h2 id=step-3-set-up-persistent-storage>Step 3: Set Up Persistent Storage<a hidden class=anchor aria-hidden=true href=#step-3-set-up-persistent-storage>#</a></h2><p>n8n needs persistent storage to save your workflows, credentials, and execution data. We&rsquo;ll create a PersistentVolumeClaim:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create a file called n8n-pvc.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>PersistentVolumeClaim</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-data</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>accessModes</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>ReadWriteOnce</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>10Gi</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>storageClassName</span>: <span style=color:#ae81ff>civo-volume</span>
</span></span></code></pre></div><p>Apply the PVC:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f n8n-pvc.yaml
</span></span></code></pre></div><h2 id=step-4-configure-n8n-environment-variables>Step 4: Configure n8n Environment Variables<a hidden class=anchor aria-hidden=true href=#step-4-configure-n8n-environment-variables>#</a></h2><p>Create a ConfigMap for n8n configuration:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create n8n-config.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ConfigMap</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span><span style=color:#f92672>data</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_HOST</span>: <span style=color:#e6db74>&#34;n8n.yourdomain.com&#34;</span> <span style=color:#75715e># Replace with your domain</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_PORT</span>: <span style=color:#e6db74>&#34;5678&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_PROTOCOL</span>: <span style=color:#e6db74>&#34;https&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>WEBHOOK_URL</span>: <span style=color:#e6db74>&#34;https://n8n.yourdomain.com/&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>GENERIC_TIMEZONE</span>: <span style=color:#e6db74>&#34;UTC&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_LOG_LEVEL</span>: <span style=color:#e6db74>&#34;info&#34;</span>
</span></span></code></pre></div><p>For sensitive data like database credentials, create a Secret:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create n8n-secrets.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Secret</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-secrets</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>Opaque</span>
</span></span><span style=display:flex><span><span style=color:#f92672>stringData</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_BASIC_AUTH_USER</span>: <span style=color:#e6db74>&#34;admin&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_BASIC_AUTH_PASSWORD</span>: <span style=color:#e6db74>&#34;your-secure-password-here&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>N8N_ENCRYPTION_KEY</span>: <span style=color:#e6db74>&#34;your-encryption-key-here&#34;</span> <span style=color:#75715e># Generate a random 32-character string</span>
</span></span></code></pre></div><p>Apply both configurations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f n8n-config.yaml
</span></span><span style=display:flex><span>kubectl apply -f n8n-secrets.yaml
</span></span></code></pre></div><h2 id=step-5-deploy-n8n>Step 5: Deploy n8n<a hidden class=anchor aria-hidden=true href=#step-5-deploy-n8n>#</a></h2><p>Now let&rsquo;s create the main n8n deployment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create n8n-deployment.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#75715e># Fix permissions for the mounted volume</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>securityContext</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>fsGroup</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>runAsGroup</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># Use an init container to fix permissions if needed</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>initContainers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>volume-permissions</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>busybox:1.35</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>command</span>:
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>sh</span>
</span></span><span style=display:flex><span>            - -<span style=color:#ae81ff>c</span>
</span></span><span style=display:flex><span>            - |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              chown -R 1000:1000 /home/node/.n8n
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              chmod -R 755 /home/node/.n8n</span>              
</span></span><span style=display:flex><span>          <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-data</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/home/node/.n8n</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>securityContext</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>n8nio/n8n:latest</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>5678</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>envFrom</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>configMapRef</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-config</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>secretRef</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-secrets</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-data</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/home/node/.n8n</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#e6db74>&#34;512Mi&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#e6db74>&#34;250m&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>limits</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#e6db74>&#34;1Gi&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#e6db74>&#34;500m&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># Give the init container time to fix permissions</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>livenessProbe</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>httpGet</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/healthz</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>port</span>: <span style=color:#ae81ff>5678</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>readinessProbe</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>httpGet</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/healthz</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>port</span>: <span style=color:#ae81ff>5678</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>securityContext</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>runAsGroup</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>allowPrivilegeEscalation</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>readOnlyRootFilesystem</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-data</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>persistentVolumeClaim</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>claimName</span>: <span style=color:#ae81ff>n8n-data</span>
</span></span></code></pre></div><p>Deploy n8n:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f n8n-deployment.yaml
</span></span></code></pre></div><h2 id=step-6-expose-n8n-with-a-service>Step 6: Expose n8n with a Service<a hidden class=anchor aria-hidden=true href=#step-6-expose-n8n-with-a-service>#</a></h2><p>Create a service to expose n8n within the cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create n8n-service.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-service</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>5678</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span></code></pre></div><p>Apply the service:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f n8n-service.yaml
</span></span></code></pre></div><h2 id=step-7-install-and-configure-cert-manager>Step 7: Install and Configure cert-manager<a hidden class=anchor aria-hidden=true href=#step-7-install-and-configure-cert-manager>#</a></h2><p>Before setting up ingress, we need cert-manager to handle SSL certificates automatically. cert-manager will obtain Let&rsquo;s Encrypt certificates for our domain.</p><p>Install cert-manager using Helm or kubectl:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Add the Jetstack Helm repository</span>
</span></span><span style=display:flex><span>helm repo add jetstack https://charts.jetstack.io
</span></span><span style=display:flex><span>helm repo update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Install cert-manager</span>
</span></span><span style=display:flex><span>helm install cert-manager jetstack/cert-manager <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --namespace cert-manager <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --create-namespace <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --version v1.12.0 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set installCRDs<span style=color:#f92672>=</span>true
</span></span></code></pre></div><p>Alternatively, you can install with kubectl:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install cert-manager CRDs</span>
</span></span><span style=display:flex><span>kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.12.0/cert-manager.crds.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create namespace</span>
</span></span><span style=display:flex><span>kubectl create namespace cert-manager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Install cert-manager</span>
</span></span><span style=display:flex><span>kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.12.0/cert-manager.yaml
</span></span></code></pre></div><p>Wait for cert-manager to be ready:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl wait --for<span style=color:#f92672>=</span>condition<span style=color:#f92672>=</span>ready pod -l app.kubernetes.io/instance<span style=color:#f92672>=</span>cert-manager -n cert-manager --timeout<span style=color:#f92672>=</span>300s
</span></span></code></pre></div><p>Now create a ClusterIssuer for Let&rsquo;s Encrypt:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create letsencrypt-issuer.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencrypt-prod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>acme</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Replace with your email address</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>email</span>: <span style=color:#ae81ff>your-email@example.com</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>: <span style=color:#ae81ff>https://acme-v02.api.letsencrypt.org/directory</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privateKeySecretRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencrypt-prod</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>solvers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>http01</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>ingress</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>class</span>: <span style=color:#ae81ff>traefik</span>
</span></span></code></pre></div><p>Apply the ClusterIssuer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f letsencrypt-issuer.yaml
</span></span></code></pre></div><p>Verify cert-manager is working:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check cert-manager pods</span>
</span></span><span style=display:flex><span>kubectl get pods -n cert-manager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check the ClusterIssuer</span>
</span></span><span style=display:flex><span>kubectl get clusterissuer letsencrypt-prod
</span></span></code></pre></div><h2 id=step-8-set-up-ingress-for-external-access>Step 8: Set Up Ingress for External Access<a hidden class=anchor aria-hidden=true href=#step-8-set-up-ingress-for-external-access>#</a></h2><p>To access n8n from the internet, we need an ingress controller. Civo clusters come with Traefik pre-installed, so we can use that:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Create n8n-ingress.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-ingress</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>n8n</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>kubernetes.io/ingress.class</span>: <span style=color:#e6db74>&#34;traefik&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>cert-manager.io/cluster-issuer</span>: <span style=color:#e6db74>&#34;letsencrypt-prod&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>traefik.ingress.kubernetes.io/redirect-entry-point</span>: <span style=color:#ae81ff>https</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>tls</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>n8n.yourdomain.com</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>n8n-tls</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>host</span>: <span style=color:#ae81ff>n8n.yourdomain.com</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>pathType</span>: <span style=color:#ae81ff>Prefix</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>name</span>: <span style=color:#ae81ff>n8n-service</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>port</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>number</span>: <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>Apply the ingress:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f n8n-ingress.yaml
</span></span></code></pre></div><h2 id=step-9-configure-dns>Step 9: Configure DNS<a hidden class=anchor aria-hidden=true href=#step-9-configure-dns>#</a></h2><p>Point your domain to your Civo cluster&rsquo;s load balancer IP. First, get the external IP:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get svc -n kube-system traefik
</span></span></code></pre></div><p>Look for the <code>EXTERNAL-IP</code> and create an A record in your DNS provider pointing <code>n8n.yourdomain.com</code> to this IP.</p><h2 id=step-10-verify-your-deployment>Step 10: Verify Your Deployment<a hidden class=anchor aria-hidden=true href=#step-10-verify-your-deployment>#</a></h2><p>Check that everything is running correctly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check pod status</span>
</span></span><span style=display:flex><span>kubectl get pods -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check service</span>
</span></span><span style=display:flex><span>kubectl get svc -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check ingress</span>
</span></span><span style=display:flex><span>kubectl get ingress -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check certificate (should show Ready=True after a few minutes)</span>
</span></span><span style=display:flex><span>kubectl get certificate -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># View logs if needed</span>
</span></span><span style=display:flex><span>kubectl logs -f deployment/n8n -n n8n
</span></span></code></pre></div><p>You should see output similar to:</p><pre tabindex=0><code>NAME   READY   STATUS    RESTARTS   AGE
n8n-xxx   1/1     Running   0          2m
</code></pre><p>For the certificate, you should see:</p><pre tabindex=0><code>NAME      READY   SECRET    AGE
n8n-tls   True    n8n-tls   2m
</code></pre><h2 id=step-11-access-n8n>Step 11: Access n8n<a hidden class=anchor aria-hidden=true href=#step-11-access-n8n>#</a></h2><p>Once your DNS has propagated (this can take a few minutes), you can access n8n at <code>https://n8n.yourdomain.com</code>. The SSL certificate should be automatically provisioned by cert-manager within a few minutes.</p><p>You&rsquo;ll be prompted to log in using the credentials you set in the Secret (admin/your-secure-password-here by default).</p><h2 id=creating-your-first-workflow>Creating Your First Workflow<a hidden class=anchor aria-hidden=true href=#creating-your-first-workflow>#</a></h2><p>Now that n8n is running, let&rsquo;s create a simple workflow to test everything:</p><ol><li><strong>Access the n8n interface</strong> at your domain</li><li><strong>Click &ldquo;New Workflow&rdquo;</strong></li><li><strong>Add a Manual Trigger node</strong> - this will be your starting point</li><li><strong>Add an HTTP Request node</strong> - configure it to make a GET request to <code>https://api.github.com/users/octocat</code></li><li><strong>Add a Set node</strong> - use this to format the response data</li><li><strong>Connect the nodes</strong> by dragging from the output of one to the input of the next</li><li><strong>Click &ldquo;Execute Workflow&rdquo;</strong> to test it</li></ol><p>This simple workflow demonstrates n8n&rsquo;s ability to fetch data from APIs and process it.</p><h2 id=production-considerations>Production Considerations<a hidden class=anchor aria-hidden=true href=#production-considerations>#</a></h2><p>For production deployments, consider these additional steps:</p><h3 id=database-configuration>Database Configuration<a hidden class=anchor aria-hidden=true href=#database-configuration>#</a></h3><p>Instead of using SQLite (the default), configure n8n to use PostgreSQL for better performance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Add to your n8n-config ConfigMap</span>
</span></span><span style=display:flex><span><span style=color:#f92672>DB_TYPE</span>: <span style=color:#e6db74>&#34;postgresdb&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>DB_POSTGRESDB_HOST</span>: <span style=color:#e6db74>&#34;your-postgres-host&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>DB_POSTGRESDB_PORT</span>: <span style=color:#e6db74>&#34;5432&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>DB_POSTGRESDB_DATABASE</span>: <span style=color:#e6db74>&#34;n8n&#34;</span>
</span></span></code></pre></div><h3 id=resource-scaling>Resource Scaling<a hidden class=anchor aria-hidden=true href=#resource-scaling>#</a></h3><p>Monitor your n8n instance and adjust resources as needed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Scale up if needed</span>
</span></span><span style=display:flex><span>kubectl scale deployment n8n --replicas<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Update resource limits</span>
</span></span><span style=display:flex><span>kubectl patch deployment n8n -n n8n -p <span style=color:#e6db74>&#39;{&#34;spec&#34;:{&#34;template&#34;:{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;n8n&#34;,&#34;resources&#34;:{&#34;limits&#34;:{&#34;memory&#34;:&#34;2Gi&#34;,&#34;cpu&#34;:&#34;1&#34;}}}]}}}}&#39;</span>
</span></span></code></pre></div><h3 id=backup-strategy>Backup Strategy<a hidden class=anchor aria-hidden=true href=#backup-strategy>#</a></h3><p>Set up regular backups of your persistent volume and export your workflows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create a backup job</span>
</span></span><span style=display:flex><span>kubectl create job n8n-backup --from<span style=color:#f92672>=</span>cronjob/n8n-backup -n n8n
</span></span></code></pre></div><h3 id=monitoring>Monitoring<a hidden class=anchor aria-hidden=true href=#monitoring>#</a></h3><p>Add monitoring to track n8n&rsquo;s performance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Add to your deployment</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>metrics</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9464</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>9464</span>
</span></span></code></pre></div><h2 id=troubleshooting-common-issues>Troubleshooting Common Issues<a hidden class=anchor aria-hidden=true href=#troubleshooting-common-issues>#</a></h2><h3 id=pod-wont-start---permission-issues>Pod Won&rsquo;t Start - Permission Issues<a hidden class=anchor aria-hidden=true href=#pod-wont-start---permission-issues>#</a></h3><p>The most common issue is permission problems with the persistent volume. Check the logs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs deployment/n8n -n n8n
</span></span></code></pre></div><p>If you see <code>EACCES: permission denied</code> errors, the deployment above includes fixes for this. However, if you&rsquo;re still having issues, you can manually fix permissions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Delete the current deployment</span>
</span></span><span style=display:flex><span>kubectl delete deployment n8n -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a one-time job to fix permissions</span>
</span></span><span style=display:flex><span>kubectl apply -f - <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: batch/v1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Job
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  name: fix-n8n-permissions
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  namespace: n8n
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  template:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      containers:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      - name: fix-permissions
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        image: busybox:1.35
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        command:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - sh
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - -c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - |
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          echo &#34;Fixing permissions for /home/node/.n8n&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          chown -R 1000:1000 /home/node/.n8n
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          chmod -R 755 /home/node/.n8n
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          echo &#34;Permissions fixed successfully&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        volumeMounts:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - name: n8n-data
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          mountPath: /home/node/.n8n
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        securityContext:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          runAsUser: 0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      volumes:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      - name: n8n-data
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        persistentVolumeClaim:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          claimName: n8n-data
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      restartPolicy: Never
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Wait for the job to complete</span>
</span></span><span style=display:flex><span>kubectl wait --for<span style=color:#f92672>=</span>condition<span style=color:#f92672>=</span>complete job/fix-n8n-permissions -n n8n --timeout<span style=color:#f92672>=</span>300s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Clean up the job</span>
</span></span><span style=display:flex><span>kubectl delete job fix-n8n-permissions -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Redeploy n8n</span>
</span></span><span style=display:flex><span>kubectl apply -f n8n-deployment.yaml
</span></span></code></pre></div><h3 id=pod-wont-start---other-issues>Pod Won&rsquo;t Start - Other Issues<a hidden class=anchor aria-hidden=true href=#pod-wont-start---other-issues>#</a></h3><p>For other startup issues:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs deployment/n8n -n n8n
</span></span></code></pre></div><p>Common issues include:</p><ul><li>Incorrect environment variables</li><li>Storage mount problems</li><li>Resource constraints</li></ul><h3 id=ssl-certificate-issues>SSL Certificate Issues<a hidden class=anchor aria-hidden=true href=#ssl-certificate-issues>#</a></h3><p>If the certificate isn&rsquo;t working:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check certificate status</span>
</span></span><span style=display:flex><span>kubectl describe certificate n8n-tls -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check cert-manager logs</span>
</span></span><span style=display:flex><span>kubectl logs -n cert-manager deployment/cert-manager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check certificate request</span>
</span></span><span style=display:flex><span>kubectl get certificaterequest -n n8n
</span></span></code></pre></div><p>Common certificate issues:</p><ul><li>DNS not pointing to the correct IP</li><li>Rate limiting from Let&rsquo;s Encrypt (wait an hour and try again)</li><li>Incorrect email in ClusterIssuer</li></ul><h3 id=cant-access-via-domain>Can&rsquo;t Access via Domain<a hidden class=anchor aria-hidden=true href=#cant-access-via-domain>#</a></h3><p>Verify your setup:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check ingress</span>
</span></span><span style=display:flex><span>kubectl describe ingress n8n-ingress -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check if cert-manager is working</span>
</span></span><span style=display:flex><span>kubectl get certificates -n n8n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Test internal connectivity</span>
</span></span><span style=display:flex><span>kubectl port-forward svc/n8n-service 8080:80 -n n8n
</span></span></code></pre></div><h3 id=workflows-not-persisting>Workflows Not Persisting<a hidden class=anchor aria-hidden=true href=#workflows-not-persisting>#</a></h3><p>Ensure your PVC is properly mounted:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe pvc n8n-data -n n8n
</span></span></code></pre></div><h2 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h2><p>Now that you have n8n running on Civo Kubernetes, you can:</p><ul><li><strong>Explore n8n&rsquo;s extensive node library</strong> - connect to hundreds of services</li><li><strong>Set up webhook workflows</strong> - trigger automation from external services</li><li><strong>Create scheduled workflows</strong> - automate recurring tasks</li><li><strong>Build complex multi-step automations</strong> - chain together multiple services</li><li><strong>Integrate with your existing tools</strong> - connect databases, APIs, and services</li></ul><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>You now have a fully functional n8n instance running on Civo Kubernetes! This setup provides a scalable foundation for your automation needs, with the flexibility to grow as your requirements evolve.</p><p>The combination of n8n&rsquo;s powerful workflow capabilities and Civo&rsquo;s developer-friendly Kubernetes platform gives you a robust automation solution that&rsquo;s both easy to manage and cost-effective.</p><p>Remember to regularly update your n8n deployment, monitor resource usage, and back up your workflows to ensure a smooth operation.</p><p>Happy automating!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.keithhubner.com/tags/kubernetes/>Kubernetes</a></li><li><a href=https://blog.keithhubner.com/tags/n8n/>N8n</a></li><li><a href=https://blog.keithhubner.com/tags/civo/>Civo</a></li><li><a href=https://blog.keithhubner.com/tags/automation/>Automation</a></li><li><a href=https://blog.keithhubner.com/tags/devops/>Devops</a></li><li><a href=https://blog.keithhubner.com/tags/cloud/>Cloud</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.keithhubner.com/>Keith Hubner</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><p>Get in touch:</p><ul style=display:flex;list-style:none;padding:0;margin:0;justify-content:center;width:100%><li style=margin-right:10px><a href=mailto:keith@hubner.co.uk>Email</a></li><li style=margin-right:10px><a href=https://linkedin.com/in/keithhubner>LinkedIn</a></li><li style=margin-right:10px><a href=https://github.com/keithhubner>GitHub</a></li></ul></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>